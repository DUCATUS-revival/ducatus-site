<section class="section-header-page" style="background-image: url(/assets/img/sections/buy-bg.png);">
    <div class="container">
        <h1 class="h1__title-page" [innerHTML]="'PAGE.BUY.TITLE' | translate"></h1>
    </div>
</section>

<section class="app">
    <div class="container">
        <div class="pay-form">
            <div class="pay-form-wrap">
                <div class="ducatus-pay-form" *ngIf="!loadingData">

                    <div class="group group-input group-input-select">
                        <label for="get-coin">{{ 'PAGE.BUY.FIELDS.ONE.TITLE' | translate }}</label>
                        <input type="number" min="0" [(ngModel)]="exchange.price.get " (ngModelChange)="setCurrentPrice('get')" [placeholder]="'PAGE.BUY.FIELDS.ONE.PLACEHOLDER' | translate" class="input input-white" oninput="this.value = this.value.replace(/[^0-9](^\,)/g, '').replace(/(\..*)\./g, '$1');">

                        <div class="select-coin select-coin-fill" (click)="exchange.select.get = !exchange.select.get; exchange.select.send = false" [ngClass]="{ 'select-coin-start': exchange.select.get }">
                            <ng-container *ngFor="let item of exchange.coins">
                                <span class="select-coin-selected" *ngIf="item.active"><img [src]="'assets/img/icons/' + item.icon + '.png'" [alt]="item.name"> {{ item.name }}</span>
                            </ng-container>
                            <div class="select-coin-list">
                                <div class="select-coin-list-wrap">
                                    <ng-container *ngFor="let item of exchange.coins">
                                        <span class="select-coin-list-item" (click)="coinSwitch(item.name,'get')" *ngIf="!item.active"><img [src]="'assets/img/icons/' + item.icon + '.png'" [alt]="item.name">{{ item.name }}</span>
                                    </ng-container>
                                </div>
                            </div>

                        </div>

                    </div>

                    <div class="group group-text group-columns">

                        <span class="text">1 {{ exchange.selected.get.fullname }} = {{ exchange.rate }} {{ exchange.selected.send.fullname }}</span>

                    </div>

                    <div class="group group-input group-input-select">
                        <label for="send-coin">{{ 'PAGE.BUY.FIELDS.TWO.TITLE' | translate }}</label>
                        <input min="0" type="number" (ngModelChange)="setCurrentPrice('send')" [(ngModel)]=" exchange.price.send" [placeholder]="'PAGE.BUY.FIELDS.TWO.PLACEHOLDER' | translate" class="input input-white" oninput="this.value = this.value.replace(/[^0-9](^\,)/g, '').replace(/(\..*)\./g, '$1');">

                        <div class="select-coin select-coin-fill" (click)="exchange.selected.get.name === 'DUC' ? exchange.select.send = !exchange.select.send  : null;exchange.select.get = false" [ngClass]="{ 'select-coin-start': exchange.select.send }">

                            <ng-container *ngFor="let item of exchange.coins">
                                <ng-container *ngIf="item.active">

                                    <ng-container *ngFor="let coin of item.coins">
                                        <span class="select-coin-selected" *ngIf="coin.active"><img [src]="'assets/img/icons/'+coin.icon+'.png'" [alt]="coin.name"> {{ coin.name }}</span>
                                    </ng-container>

                                    <div class="select-coin-list" [ngClass]="{ 'select-coin-start': exchange.select.send }">

                                        <div class="select-coin-list-wrap">
                                            <ng-container *ngFor="let coin of item.coins">
                                                <span class="select-coin-list-item" *ngIf="!coin.active" (click)="coinSwitch(coin.name,'send')"><img [src]="'assets/img/icons/' + coin.icon +'.png'" [alt]="coin.name">{{ coin.name }}</span>
                                            </ng-container>
                                        </div>

                                    </div>


                                </ng-container>
                            </ng-container>

                        </div>
                    </div>

                    <div class="group group-input">
                        <label for="ducatus-address">{{ 'PAGE.BUY.FIELDS.THREE.TEXT_1' | translate }} {{ exchange.selected.get.fullname }} {{ 'PAGE.BUY.FIELDS.THREE.TEXT_2' | translate }}</label>
                        <input type="text" [ngClass]="{'text' : exchange.address.validate || exchange.address.loading }" [disabled]="exchange.address.validate || exchange.address.loading" [(ngModel)]="exchange.address.to" (ngModelChange)="setAddress()" [placeholder]="('PAGE.BUY.FIELDS.THREE.PLACEHOLDER_1' | translate) + ' ' + exchange.selected.get.fullname + ' ' + ('PAGE.BUY.FIELDS.THREE.PLACEHOLDER_2' | translate)" class="input input-white" oninput="this.value = this.value.replace('ducatus:', '');">
                        <span class="error-address-value" *ngIf="exchange.address.error">{{ 'PAGE.BUY.FIELDS.THREE.ERROR' | translate }}</span>
                    </div>

                    <div id="loading-address" [ngClass]="{ 'loading-address-start': exchange.address.loading }" class="group group-block group-input group-input-copy m-b-0 qr-wrap">
                        <div class="group-wrap qr-address">
                            <label>{{ 'PAGE.BUY.FIELDS.FOUR.TEXT_1' | translate }} {{ exchange.selected.send.fullname }} {{ 'PAGE.BUY.FIELDS.FOUR.TEXT_2' | translate }} </label>
                            <p class="input input-accent">{{ exchange.selected.send.address }}</p>
                            <span class="copy-address icon icon-copy"></span>
                        </div>
                        <div class="qrcode">
                            <qrcode *ngIf="exchange.address.qr" class="qr-code" [elementType]="'url'" [margin]="0" [scale]="1" [qrdata]="exchange.selected.send.address" [width]="60" [errorCorrectionLevel]="'L'"></qrcode>
                        </div>

                        <div class="loading-address-qr">
                            <div class="loading-address-qr-wrap">
                                <p>{{ 'PAGE.BUY.FIELDS.FOUR.ERROR' | translate }}</p>
                                <div class="loading-address-qr-wrap-ellips">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </div>
                        </div>

                        <div class="group group-text qr-text">
                            <span class="text-attantion"><span class="attantion">{{ 'PAGE.BUY.FIELDS.FIVE.TEXT_1' | translate }}!</span> {{ 'PAGE.BUY.FIELDS.FIVE.TEXT_2' | translate }}{{ exchange.selected.get.fullname }} {{ 'PAGE.BUY.FIELDS.FIVE.TEXT_3' | translate }} {{ exchange.selected.send.text }}<br><br></span>
                        </div>

                    </div>

                </div>
                <div class="ducatus-pay-form loading-pay-form" *ngIf="loadingData">
                    <div class="group group-input group-input-select input-h-60"></div>
                    <div class="group group-text group-columns input-h-20"></div>
                    <div class="group group-input group-input-select input-h-85"></div>
                    <div class="group group-input input-h-105"></div>
                    <div class="group group-input group-input-select input-h-60"></div>
                    <div class="group group-text group-columns input-h-20"></div>
                </div>
            </div>
            <div class="pay-form-block">
                <div class="pay-form-block-video">
                    <iframe src="https://www.youtube.com/embed/5tzX8UzUQkE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>

                <div class="pay-form-block-text">
                    <p class="p__text-section icon icon__wallet_2" [innerHTML]="'PAGE.BUY.TEXT' | translate"></p>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="modal" *ngIf="modal">
    <div class="modal-wrap">
        <div class="modal-content-top">
            <p [innerHTML]="'PAGE.BUY.MODAL.TEXT' | translate"></p>
        </div>
        <div class="modal-content-bottom">
            <div class="input-checkbox-group">
                <label for="terms" [innerHTML]="'PAGE.BUY.MODAL.TERMS' | translate"></label>
                <input type="checkbox" (ngModelChange)="modalAccept = !modalAccept" [ngModel]="modalAccept" name="terms" id="terms" class="terms">
            </div>
            <button id="btn-modal" (click)="acceptModalTerms()" [disabled]="!modalAccept" class="btn btn-red"> {{ 'PAGE.BUY.MODAL.BUTTON' | translate }}</button>
        </div>
    </div>
</div>